# Advanced Exploitation Lab

This repository documents an advanced exploitation lab performed in a controlled environment.  
All observations, findings, and outcomes are strictly based on **actual commands executed, responses received, and access achieved** during testing.

---

## Lab Environment

- Target OS: Ubuntu 20.04 LTS
- Target IP: 10.49.129.128
- Access Type: Web Application → System Access
- Tools Used:
  - Python
  - Netcat
  - LinPEAS
  - SSH
  - Linux native utilities

---

## 1. Initial Reconnaissance

Initial inspection of the web application landing page did not reveal any direct vulnerabilities or exploitable functionality.

**Observation**
- No obvious input fields or exploitable parameters were present
- Application appeared static and benign at first glance

---

## 2. Directory Enumeration

Directory busting was performed to identify hidden or unlinked application resources.

**Finding**
- A hidden endpoint named `messages.html` was discovered

**Observation**
- The endpoint was publicly accessible
- Functionality differed from the main landing page

 <img width="666" height="263" alt="Web_Application_Message_Endpoint_Enumeration" src="https://github.com/user-attachments/assets/eafa5401-c5c0-444f-b5f2-56c7f665c0e0" />


---

## 3. File Inclusion Parameter Discovery

Further analysis of `messages.html` revealed the presence of a file retrieval parameter.

<img width="929" height="256" alt="LFI_via_PHP_Filter_Parameter_Confirmed" src="https://github.com/user-attachments/assets/ac1027b0-9828-4b35-a23d-f8cc85b13465" />

**Finding**
- A file-based GET parameter was identified
- Parameter accepted local file paths

**Observation**
- Parameter behavior suggested potential file inclusion
- Input was not properly sanitized

---

## 4. Local File Inclusion (LFI) Exploitation

The identified file parameter was tested for Local File Inclusion.

**Observed Results**
- Successful read of `/etc/passwd`
- Confirmed arbitrary local file read capability

**Impact**
- Disclosure of system users
- Confirmation of server-side file access


---

## 5. LFI to Remote Code Execution (RCE)

Further research identified a PHP filter chain technique capable of escalating LFI into Remote Code Execution.

<img width="1085" height="832" alt="SUID_Misconfiguration_Privilege_Escalation_Vector" src="https://github.com/user-attachments/assets/05c8a9a8-8766-4eb1-924c-8db6fe60f894" />

**Attack Flow**
- PHP filter chain payload generated
- Payload executed via crafted curl request
- Request sent to attacker-controlled Python HTTP server
- Bash reverse shell payload delivered

<img width="912" height="164" alt="PHP_Filter_Chain_Payload_Generation_for_RCE" src="https://github.com/user-attachments/assets/043fdb92-e11f-455e-a911-7732882d0f06" />

**Observed Results**
- Target executed supplied payload
- Reverse shell successfully initiated

<img width="1132" height="323" alt="PHP_Filter_Chain_Request_Captured_Confirming_LFI_to_RCE_Vector" src="https://github.com/user-attachments/assets/bb2abc49-623a-446c-90c9-0febd944a6d9" />


<img width="642" height="177" alt="HTTP_Server_Reverse_Shell_Payload_Delivery" src="https://github.com/user-attachments/assets/abba3a40-8575-43a4-a075-6a2740420b75" />


<img width="712" height="142" alt="Reverse_Shell_Established_via_Netcat_Listener" src="https://github.com/user-attachments/assets/f83e5e68-6b3c-40ef-84f4-e341165e63ee" />

---

## 6. Initial Shell Access

A reverse shell was received on the attacker machine using Netcat.

**Observation**
- Shell access obtained under a low-privileged user
- Interactive command execution confirmed

---

## 7. SSH Backdoor via Authorized Keys

While enumerating the compromised user’s home directory, write access to the `authorized_keys` file was identified.

<img width="612" height="135" alt="SSH_Key_Pair_Generation_Attacker_Machine" src="https://github.com/user-attachments/assets/beaf6824-f2f1-4288-809c-f4996b1d24f7" />

**Finding**
- `authorized_keys` file was writable

**Action**
- Attacker SSH public key added to `authorized_keys`

<img width="1312" height="115" alt="SSH_Public_Key_Injected_and_Verified_in_Authorized_Keys" src="https://github.com/user-attachments/assets/71446095-f1c3-456c-8bac-c0ab29816584" />

**Outcome**
- Persistent SSH access established
- Stable shell achieved without re-exploitation

<img width="618" height="734" alt="SSH_Initial_Access_Established_on_Target_Server" src="https://github.com/user-attachments/assets/717f3e8c-a2ab-4ce9-991f-1873f335b4ce" />

---

## 8. Privilege Escalation Enumeration

With stable SSH access, privilege escalation enumeration was performed.

**Tool Used**
- LinPEAS

**Observed Results**
- Discovery of a system service executable by the compromised user
- Service behavior indicated privileged file operations

<img width="1774" height="416" alt="LinPEAS_Privilege_Escalation_Enumeration_Script_Download" src="https://github.com/user-attachments/assets/86efc7de-0df2-4414-86ec-59338e2b2ff5" />

---

## 9. Privilege Escalation via SUID Binary Creation

Further analysis revealed that the identified service creates an `xxd` binary with the SUID bit set.

**Observed Behavior**
- Service execution resulted in SUID-enabled `xxd` binary
- Binary executed with root privileges

<img width="888" height="175" alt="Systemd_Service_Executing_Privileged_SUID_Binary_Creation" src="https://github.com/user-attachments/assets/a82308fd-c7a8-42bb-ad30-d8520b8b579d" />

**Impact**
- Arbitrary root-level file read capability


<img width="547" height="141" alt="Privilege_Escalation_Final_State" src="https://github.com/user-attachments/assets/e9256647-73da-41a7-805b-1551111c8668" />

---

## 10. Root File Access

The SUID-enabled `xxd` binary was abused to read restricted root-owned files.

**Observed Results**
- `/etc/shadow` successfully read
- Root-level file access confirmed

<img width="1567" height="765" alt="Sensitive_Password_Hash_File_Read_via_SUID_XXD_Privilege_Escalation" src="https://github.com/user-attachments/assets/2053d5b0-5bcb-4c25-8efa-dda204440677" />


---

## Conclusion

This lab demonstrates a realistic exploitation chain beginning with **directory enumeration**, progressing through **LFI**, escalating to **RCE**, followed by **SSH persistence**, and concluding with **privilege escalation via SUID misconfiguration**.

The compromise was achieved through:
- Hidden endpoint discovery
- Improper file handling
- Abuse of PHP filter chains
- Weak file permissions
- Insecure service configuration

No kernel exploits or brute force techniques were required — only logical weaknesses chained together.

---
