# Chained Exploit Demonstration: Stored XSS, Admin Access, and Remote Code Execution (RCE)

## Overview
This project documents a chained exploitation scenario performed in an authorized lab environment using **Damn Vulnerable Web Application (DVWA)**. The assessment demonstrates how a **Stored Cross-Site Scripting (XSS)** vulnerability was used to hijack an authenticated user session and gain **administrative access**, which then allowed exploitation of a **Command Injection** vulnerability to achieve **Remote Code Execution (RCE)**.

The objective of this exercise is to demonstrate realistic exploit chaining where XSS acts as an access enabler and command injection serves as the execution vector, aligned with VAPT and PTES standards.

---

## Environment Details
- **Target Application:** Damn Vulnerable Web Application (DVWA)
- **Target IP:** `10.49.161.227`
- **Attacker Machine:** Kali Linux
- **Security Level:** Low
- **Scope:** Authorized lab environment only

---

## Attack Chain Summary


---

## Exploitation Details

### 1. Admin Access via Stored XSS
<img width="735" height="228" alt="cookie hijack" src="https://github.com/user-attachments/assets/aeb700a9-fb0b-493f-a038-ec160e94087b" />

- A Stored XSS vulnerability was exploited to execute malicious JavaScript in an administrator’s browser.
- The payload exfiltrated the administrator’s session cookie (`PHPSESSID`).
- The stolen cookie was manually injected into a separate browser session.
- Using this cookie, the attacker successfully logged in with **administrative privileges** without credentials.

**Impact:**
- Administrative account takeover
- Unauthorized access to restricted functionality

---

### 2. Command Injection Using Admin Access
<img width="1920" height="1080" alt="command injection execution" src="https://github.com/user-attachments/assets/cc657549-a26a-465e-9955-e6f5cf3ca877" />

- With administrative access, the attacker accessed the DVWA **Command Injection** module.
- Arbitrary system command execution was confirmed using the `id` command.
- Output verified execution under the `www-data` user context.

**Impact:**
- Server-side command execution
- Validation of command injection vulnerability

---

### 3. Remote Code Execution via Command Injection
<img width="937" height="182" alt="reverse shell" src="https://github.com/user-attachments/assets/5e7b2426-7d8e-476f-8198-4b43c3188de6" />

- A Bash reverse shell payload was injected through the command injection vulnerability.
- The target system initiated an outbound connection to the attacker machine.
- An interactive shell was obtained under the web service account (`www-data`).

**Impact:**
- Remote Code Execution on the target system
- Full control of the web application execution context
- Potential for privilege escalation and lateral movement

---

## Exploit Chain Log

| Exploit ID | Exploit Type | Result |
|-----------|-------------|--------|
| 001 | Stored XSS | Admin Access |
| 002 | Command Injection | Remote Code Execution |

---

## Risk Assessment
- **Overall Severity:** Critical
- **OWASP Top 10 Mapping:**
  - A03: Injection
  - A07: Identification and Authentication Failures
- **Business Impact:**
  - Administrative account takeover
  - Arbitrary command execution on the server
  - Potential data exposure and service compromise

---

## Conclusion
This assessment highlights how a Stored XSS vulnerability, while not directly leading to code execution, enabled administrative access through session hijacking. This access exposed a critical command injection flaw, which was subsequently exploited to achieve Remote Code Execution. The attack chain demonstrates how access-level vulnerabilities can significantly amplify the impact of server-side flaws.

---
