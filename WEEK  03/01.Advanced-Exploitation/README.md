# Chained Exploit Demonstration: Stored XSS to Remote Code Execution (RCE)

## Overview
This project documents a successful chained exploitation scenario performed in an authorized lab environment using **Damn Vulnerable Web Application (DVWA)**. The attack demonstrates how a **Stored Cross-Site Scripting (XSS)** vulnerability can be leveraged to hijack an authenticated user session and escalated into **Remote Code Execution (RCE)** via command injection.

The objective of this exercise is to illustrate real-world exploit chaining, evidence collection, and professional reporting aligned with VAPT and PTES standards.

---

## Environment Details
- **Target Application:** DVWA (TryHackMe Lab)
- **Target IP:** `10.49.161.227`
- **Attacker Machine:** Kali Linux
- **Security Level:** Low
- **Scope:** Authorized lab environment only

---

## Attack Chain Summary

---

### 1. Session Hijacking via Stored XSS
 `cookie hyjack.png`
<img width="735" height="228" alt="cookie hyjack" src="https://github.com/user-attachments/assets/aeb700a9-fb0b-493f-a038-ec160e94087b" />

- A Stored XSS payload was used to exfiltrate the victimâ€™s session cookie.
- The stolen `PHPSESSID` was captured using a Netcat listener on port 80.
- The cookie was later reused to impersonate an authenticated user.

**Impact:**
- Authentication bypass
- Unauthorized access to restricted application functionality

---

### 2. Command Injection Execution
 `payload execution.png`
<img width="1920" height="1080" alt="payload execution" src="https://github.com/user-attachments/assets/cc657549-a26a-465e-9955-e6f5cf3ca877" />

- Using the hijacked session, the attacker accessed the DVWA Command Injection module.
- Arbitrary command execution was confirmed using the `id` command.
- Output verified execution under the `www-data` user context.


**Impact:**
- Server-side command execution
- Confirmation of Remote Code Execution capability

---

### 3. Reverse Shell Establishment
`shell.png`
<img width="937" height="182" alt="shell" src="https://github.com/user-attachments/assets/5e7b2426-7d8e-476f-8198-4b43c3188de6" />

- A Bash reverse shell payload was injected through the vulnerable parameter.
- The target successfully initiated an outbound connection to the attacker.
- An interactive shell was obtained on the target system.

**Evidence:**

**Impact:**
- Full control of the web server under web service privileges
- Potential for privilege escalation and lateral movement

---

## Exploit Chain Log

| Exploit ID | Description         | Target IP       | Status  | Payload             |
|-----------|---------------------|-----------------|---------|---------------------|
| 004       | XSS to RCE Chain    | 10.49.161.227   | Success | Bash Reverse Shell  |

---

## Risk Assessment
- **Overall Severity:** Critical
- **OWASP Categories:**
  - A03: Injection
  - A07: Identification and Authentication Failures
- **Business Impact:**
  - Account takeover
  - Remote command execution
  - Data exposure and service compromise
---
